<tool id="base_count_starting_reads_per_fq" name="Count_reads_per_fq file for BASE"  version="21.1.13">
    <description>with awk</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command>
<![CDATA[
        FQLINEFN=$(wc -l '$READ')
        FQLINE=$(echo $FQLINEFN | cut -d" " -f1)
        NUMREAD=$(( FQLINE / 4 ))
        FN=$(echo $FQLINEFN | cut -d" " -f2)

        ## count number of starting reads - same for G1 and G2 refs
        echo $NUMREAD | awk -v fq='${READ}' -v gq=pre_aln_read_count '{print "filename" "," gq "\n" fq "," $0}' > '$counts'
]]>
    </command>
    <environment_variables>
        <environment_variable name="FQLINEFN">$(wc -l '$READ')</environment_variable>
    </environment_variables>
    <inputs>
        <param name="READ" format="fastq" type="data" label="Input fq file to count reads" />
    </inputs>
    <outputs>
        <data name="outfile" format="tabular" label="${tool.name} on ${on_string} FQ read counts" />
    </outputs>
    <help><![CDATA[
    **What it does**
    This tool uses awk to count the number of reads in a fastq file.

    ]]></help>
    <citations>
            <citation type="bibtex">@ARTICLE{Miller20BASE,
            author = {Brecca Miller, Alison M. Morse, Elyse Borgert, Zihao Liu, Kelsey Sinclair, Gavin Gamble, Fei Zou, Jeremy Newman, Luis Leon Novello, Fabio Marroni, Lauren M. McIntyre},
            title = {Testcrosses are an efficient strategy for identifying cis regulatory variation: Bayesian analysis of allele imbalance among conditions (BASE)},
            journal = {????},
            year = {submitted for publication}
            }</citation>
        </citations>
</tool>
