<tool id="check_sam_present" name="Verify that two input SAM files are present" version="21.1.13">
    <description>verify 2 SAM files are present for every 1 FASTQ file.</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command><![CDATA[
    check_sam_present.py
    --fq=$fq.element_identifier
    --alnType=$alnType
    --sam1=$sam1
    --sam2=$sam2
    --out=$out
]]></command>
    <inputs>
        <param name="alnType" size="30" type="select" value="" display="radio" label="Align Type" help="For BayesASE without modification, select Single End. Select whether SAM files were created from single end or paired end alignments.">
            <option value="SE" selected="true">Single End</option>
            <option value="PE" selected="true">Paired End</option>
        </param>
        <param name="sam1" type="data" format="sam" label="Unique SAM for G1" help="Select the SAM file [from BWASplitSAM] for updated genome1 containing only uniquely mapped reads."/>
        <param name="sam2" type="data" format="sam" label="Unique SAM for G2" help="Select the SAM file [from BWASplitSAM] for updated genome2 containing uniquely mapped reads. "/>
        <param name="fq" type="data" format="fastq" label="FastQ file" help="Select the FastQ file used to generate the SAM files." />
    </inputs>
    <outputs>
        <data name="out" format="tabular" label="${tool.name} on ${on_string}:Check for 2 SAM Files"/>
    </outputs>
    <tests>
        <test>
            <param name="fq" ftype="data" value="align_and_counts_test_data/W55_M_1_1.fastq"/>
            <param name="alnType" ftype="select" value="SE"/>
            <param name="sam1" ftype="data"      value="align_and_counts_test_data/W1118_G1_unique_sam_for_BASE.sam"/>
            <param name="sam2" ftype="data"      value="align_and_counts_test_data/W55_G2_unique_sam_for_BASE.sam"/>
            <output name="out"       file="align_and_counts_test_data/check_SAM_present_BASE_test_data.tabular" />
        </test>
    </tests>
    <help><![CDATA[

**Tool Description**

This tool checks to make sure that **2 SAM files** were generated from **1 FASTQ file** (one for each updated parental genome).

**NOTE:**  If you are running the BayesASE Align and Count workflow without modification, all reads are aligned as Single End - select Single End


**Inputs**

**FASTQ File [Required]**

The FASTQ file used to generate the SAM files

**Alignment Type [Required]**

Select from drop-down menu how the FASTQ file was aligned - this will be SE if running the BayesASE workflow.

**2 Unique SAM files [Required]**
-Two SAM files containing uniquely mapping reads. These can be created by the *BWASplitSAM Tool*.

(1) The unique SAM file generated by alignments to updated genome1
(2) The unique SAM file generated by alignments to updated genome2


**Output**

	(1) A single TSV file containing information on whether 2 SAM files are present per FASTQ file or not.

Example of output:

    +-------------------+--------------------------+
    |   fqName          |   message                |
    +===================+==========================+
    |dataset_1795.dat   | Have 2 SAM files - good! |
    +-------------------+--------------------------+

    ]]></help>
    <citations>
            <citation type="bibtex">@ARTICLE{Miller20BASE,
            author = {Brecca Miller, Alison M. Morse, Elyse Borgert, Zihao Liu, Kelsey Sinclair, Gavin Gamble, Fei Zou, Jeremy Newman, Luis Leon Novello, Fabio Marroni, Lauren M. McIntyre},
            title = {Testcrosses are an efficient strategy for identifying cis regulatory variation: Bayesian analysis of allele imbalance among conditions (BASE)},
            journal = {????},
            year = {submitted for publication}
            }</citation>
        </citations>
</tool>
